package tk.germanbot.data

import com.amazonaws.services.dynamodbv2.datamodeling.*
import com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBMapperFieldModel.DynamoDBAttributeType.S
import org.socialsignin.spring.data.dynamodb.repository.EnableScan
import org.springframework.data.repository.CrudRepository
import java.util.*

const val QUIZ_TABLE_NANE = "german_bot_quiz"

@DynamoDBTable(tableName = QUIZ_TABLE_NANE)
data class Quiz(
        @DynamoDBHashKey
        @DynamoDBAutoGeneratedKey
        var id: String? = null,
        @DynamoDBAttribute
        @DynamoDBTyped(S)
        var date: Date? = Date(),
        @DynamoDBAttribute
        var question: String?,
        @DynamoDBAttribute
        var answers: Set<String>?,
        @DynamoDBAttribute
        var topics: Set<String>?
)

@EnableScan
interface QuizRepository : CrudRepository<Quiz, String> {
    fun findOneById(id: String): Quiz

    override fun findAll(): List<Quiz>

    fun findByTopicsContaining(topics: String): List<Quiz>
}

